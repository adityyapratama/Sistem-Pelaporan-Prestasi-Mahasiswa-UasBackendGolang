
```markdown
# ðŸš€ API Testing Guide - Sistem Pelaporan Prestasi Mahasiswa

Panduan ini berisi langkah-langkah untuk melakukan testing API secara urut agar tidak terjadi error relasi database. Pastikan mengikuti tahapan dari registrasi hingga verifikasi.

## ðŸ›  Persiapan Awal

1. **Jalankan Database & Server:**
   ```bash
   # Nyalakan PostgreSQL via Docker
   docker compose up -d

   # Jalankan Server Go
   go run main.go

```

2. **Import Postman Collection:**
Gunakan file `Sistem_Pelaporan_Prestasi_Mahasiswa.postman_collection.json`.
3. **Set Role ID di Postman Variables:**
Karena sistem menggunakan UUID, ambil ID role dari database setelah sistem berjalan:
```sql
SELECT id, name FROM roles;

```


Copy-paste UUID tersebut ke **Collection Variables** di Postman:
* `role_id_admin`
* `role_id_dosen`
* `role_id_mahasiswa`



---

## ðŸ”„ Urutan Testing (Happy Path)

### Tahap 1: Auth & User Setup

Lakukan registrasi untuk ketiga role utama.

1. **Register & Login Admin**: Untuk mendapatkan akses awal.
2. **Register & Login Dosen**: Login diperlukan untuk mendapatkan token dosen.
3. **Register & Login Mahasiswa**: Login diperlukan untuk mendapatkan token mahasiswa.
4. **Cek Profile**: Gunakan endpoint `/auth/profile` untuk memastikan token valid.

### Tahap 2: Profiling (Data Master)

**PENTING:** Anda tidak bisa membuat prestasi sebelum profil dosen/mahasiswa terdaftar di tabel SQL.

1. **Dosen**: POST `/lectures` (Lengkapi data NIP/Departemen).
2. **Mahasiswa**: POST `/students` (Lengkapi data NIM/Prodi).
3. **Assign Pembimbing**: Login sebagai **Admin**, lalu gunakan `PUT /students/{id}/advisor` untuk memplot dosen ke mahasiswa.

### Tahap 3: Alur Prestasi

1. **Upload Lampiran**: POST `/achievements/upload` (Simpan URL filenya).
2. **Create Achievement**: POST `/achievements`. Status awal adalah `draft`.
3. **Submit**: PATCH `/achievements/{id}/submit`. Status berubah jadi `submitted`. Data sekarang muncul di dashboard Dosen.

### Tahap 4: Verifikasi & Laporan

1. **Dosen Verify**: Login sebagai Dosen, lakukan PATCH `/achievements/{id}/verify`.
2. **Admin Report**: Cek statistik akhir di `/reports/statistics`.

---

## ðŸ“‹ Contoh Payload Penting

### 1. Buat Prestasi (Mahasiswa)

```json
{
    "type": "competition",
    "title": "Juara 1 Hackathon Nasional 2024",
    "description": "Smart City Innovation",
    "details": {
        "event_name": "Hackathon Indonesia",
        "organizer": "Kominfo",
        "rank": "Juara 1",
        "team_members": ["Andi", "Budi"]
    },
    "tags": ["hackathon", "2024"]
}

```

### 2. Verifikasi (Dosen)

```json
{
    "status": "verified",
    "notes": "Sertifikat valid, data sesuai dengan bukti fisik."
}

```

---

## ðŸš¦ Status & Flow Data

| Status | Deskripsi | Aktor |
| --- | --- | --- |
| `draft` | Data tersimpan di MongoDB, bisa diedit. | Mahasiswa |
| `submitted` | Terkunci, menunggu pengecekan dosen. | Mahasiswa |
| `verified` | Selesai, masuk ke statistik laporan. | Dosen |
| `rejected` | Ditolak, butuh perbaikan. | Dosen |

## ðŸ”‘ Tips Testing

* **Bearer Token**: Pastikan `access_token` dari hasil login dimasukkan ke tab *Authorization* di Postman.
* **UUID**: Selalu perhatikan UUID yang diminta di URL (seperti `student_id` atau `achievement_id`). Ambil dari response body endpoint sebelumnya.
* **Database Cleanup**: Jika ingin reset data, jalankan `docker compose down -v` lalu up kembali.

---

